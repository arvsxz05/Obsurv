{% load static %}
<html>
<head>
	<title>Obsurv</title>
	<link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" href="{% static 'css/materialize.min.css' %}">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body>
	
	<div class="navbar-fixed">
		<nav>
			<div class="container nav-wrapper">
				<a href="#!" class="brand-logo"><i class="material-icons">cloud</i>Logo</a>
				<ul class="right hide-on-med-and-down">
				<li><a href="#!"><i class="material-icons">search</i></a></li>
				<li><a href="#!"><i class="material-icons">view_module</i></a></li>
				<li><a href="#!"><i class="material-icons">refresh</i></a></li>
				<li><a href="#!"><i class="material-icons">more_vert</i></a></li>
				</ul>
			</div>
		</nav>
	</div>
	<center><h1>Welcome to Obsurv, {{ request.user.username }}</h1></center>
	<div class="row container">
		<div class="card">
			<div class="card-content">
				<div class="input-field">
		            <textarea id="textarea1" class="materialize-textarea" data-length="200"></textarea>
		            <label for="textarea1">Write Question</label>
	          	</div>
	        	<ul id="choices_space">
	        		<li>
	        			<div class="input-field">
		        			<i class="material-icons prefix">input</i>
		        			<input placeholder="Enter a Choice" id="first_name" type="text" data-length="100" onkeyup="blurFunction()">
		        		</div>
		        	</li>
	        	</ul>
		    </div>
		    <div class="card-action">
				<button class="waves-effect waves-light btn"><i class="material-icons left">assessment</i>Create Poll</button>
			</div>
		</div>
	</div>
	
	{% for temp_question in questions %}
        <div class="row">
			<div class="col s12 m6">
				<div class="card blue-grey darken-1">
					<form method="POST">
						{% csrf_token %}
						<div class="card-content white-text">
							<span class="card-title">{{ temp_question.user_owner.username }}</span>
							<p>{{ temp_question.question_text }}</p>
							{% for single_choice in temp_question.Choices.all %}
								<p>
									<input class="with-gap" name="response" type="radio" id="{{ single_choice.pk }}"  />
									<label for="{{ single_choice.pk }}">"{{ single_choice.choice_text }}"</label>
								</p>
							{% endfor %}
						</div>
						<div class="card-action">
							<button class="waves-effect waves-light btn"><i class="material-icons left">assessment</i>Respond</button>
						</div>
					</form>
				</div>
			</div>
    	</div>
    {% endfor %}
    <script type="text/javascript">
    	function blurFunction () {
    		var choices_space = document.getElementById("choices_space");
    		var list_items = choices_space.children;
    		var li_value;
	    	for (var i = 0; i < list_items.length; i++) {
	    		li_value = list_items[i].children[0].children[1].value;
	    		if((li_value == undefined || li_value.trim() == "") && i != list_items.length-1) {
	    			list_items[i].remove();
	    		}
	    	};
	    	if (li_value != undefined && li_value.trim() != "") {
	    		
	    		var cln = choices_space.children[list_items.length-1];
	    		// console.log("here");
	    		child = cln.cloneNode(true);
	    		child.children[0].children[1].value = "";
	    		choices_space.appendChild(child);
	    	}
    	}
    	
    </script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="{% static 'js/materialize.min.js' %}"></script>
</body>
</html>